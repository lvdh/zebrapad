<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>Zebrapad - Print ZPL Label</title>
        <link rel="stylesheet" href="/static/bulma.min.css" />
        <link rel="stylesheet" href="/static/style.css" />
    </head>
    <body>
        <section class="section">
            <div class="container">
                <h1 class="title">Zebrapad</h1>
                <form id="zplForm">
                    <div class="field">
                        <label class="label">ZPL Code</label>
                        <div class="control">
                            <textarea
                                class="textarea"
                                id="zpl"
                                name="zpl"
                                rows="8"
                            >
^XA^FO50,50^ADN,36,20^FDTest Label^FS^XZ
                            </textarea>
                        </div>
                    </div>
                    <div class="control">
                        <button class="button is-primary" type="submit">
                            Print
                        </button>
                    </div>
                </form>
                <div id="result" class="notification is-hidden"></div>
            </div>
        </section>
        <script>
            document
                .getElementById("zplForm")
                .addEventListener("submit", async function (e) {
                    e.preventDefault();
                    const zpl = document.getElementById("zpl").value;
                    const res = await fetch("/print", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({ zpl }),
                    });
                    const resultDiv = document.getElementById("result");
                    if (res.ok) {
                        resultDiv.className = "notification is-success";
                        resultDiv.textContent = "Label sent to printer!";
                    } else {
                        const data = await res.json();
                        resultDiv.className = "notification is-danger";
                        resultDiv.textContent =
                            data.error || "Error sending label";
                    }
                    resultDiv.classList.remove("is-hidden");
                });
        </script>
    </body>
</html>
